<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/rushishah/work/beginners-luck/src/Lib.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span></a>
<span class=hs-linenum>  2: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Lib</span>
<span class=hs-linenum>  3: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>getMostRecentCandles</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  4: </span>      <span class='hs-varid'>displayCandles</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  5: </span>      <span class='hs-varid'>sma</span>
<span class=hs-linenum>  6: </span>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>-- Coinbase stuff</span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>MarketData</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<span class=hs-linenum> 11: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span><span class='hs-varop'>.</span><span class='hs-conid'>Core</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>-- Clock stuff</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Time</span><span class='hs-varop'>.</span><span class='hs-conid'>Clock</span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Time</span><span class='hs-varop'>.</span><span class='hs-conid'>LocalTime</span>
<span class=hs-linenum> 16: </span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>-- Graphics stuff</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>Chart</span><span class='hs-varop'>.</span><span class='hs-conid'>Easy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>E</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>Chart</span><span class='hs-varop'>.</span><span class='hs-conid'>Backend</span><span class='hs-varop'>.</span><span class='hs-conid'>Diagrams</span> <span class='hs-layout'>(</span><span class='hs-varid'>toFile</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 20: </span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>-- Haskell stuff</span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Ratio</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>-- Beginners luck stuff</span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Types</span>
<span class=hs-linenum> 26: </span>
<span class=hs-linenum> 27: </span><span class='hs-comment'>-- | Converts from the candle type given by the API to the candle type needed for the chart</span>
<span class=hs-linenum> 28: </span><span class='hs-definition'>toChartCandle</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CoinbaseCandle</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>E</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-conid'>LocalTime</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum> 29: </span><a class=annot href="#"><span class=annottext>Coinbase.Exchange.Types.MarketData.Candle -&gt; (Graphics.Rendering.Chart.Plot.Candle.Candle Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double)</span><span class='hs-definition'>toChartCandle</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>MarketData</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>utcTime</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>o</span> <span class='hs-varid'>c</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> 
<span class=hs-linenum> 30: </span>  <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; (Graphics.Rendering.Chart.Plot.Candle.Candle Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double)</span><span class='hs-conid'>E</span></a><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>time</span> <span class='hs-varid'>low</span> <span class='hs-varid'>open</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == open + close}</span><span class='hs-varid'>open</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; x2:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <span class='hs-varid'>close</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; x2:{v : GHC.Types.Double | v /= 0
                                                  &amp;&amp; v /= 0.0} -&gt; {v : GHC.Types.Double | v == x1 / x2
                                                                                          &amp;&amp; v == x1 / x2}</span><span class='hs-varop'>/</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-varid'>close</span> <span class='hs-varid'>high</span>
<span class=hs-linenum> 31: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 32: </span>    <span class='hs-comment'>-- | Convert a UTCTime to a LocalTime with the default time zone</span>
<span class=hs-linenum> 33: </span>    <a class=annot href="#"><span class=annottext>Data.Time.LocalTime.LocalTime.LocalTime</span><span class='hs-varid'>time</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Data.Time.LocalTime.TimeZone.TimeZone -&gt; Data.Time.Clock.UTC.UTCTime -&gt; Data.Time.LocalTime.LocalTime.LocalTime | v == Data.Time.LocalTime.LocalTime.utcToLocalTime}</span><span class='hs-varid'>utcToLocalTime</span></a> <span class='hs-varid'>utc</span> <span class='hs-varid'>utcTime</span>
<span class=hs-linenum> 34: </span>    <span class='hs-comment'>-- | Extract values from their type wrappers</span>
<span class=hs-linenum> 35: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>low</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.Low -&gt; GHC.Types.Double | v == Coinbase.Exchange.Types.MarketData.unLow}</span><span class='hs-varid'>unLow</span></a> <span class='hs-varid'>l</span>
<span class=hs-linenum> 36: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>open</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.Open -&gt; GHC.Types.Double | v == Coinbase.Exchange.Types.MarketData.unOpen}</span><span class='hs-varid'>unOpen</span></a> <span class='hs-varid'>o</span>
<span class=hs-linenum> 37: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>close</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.Close -&gt; GHC.Types.Double | v == Coinbase.Exchange.Types.MarketData.unClose}</span><span class='hs-varid'>unClose</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 38: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>high</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.High -&gt; GHC.Types.Double | v == Coinbase.Exchange.Types.MarketData.unHigh}</span><span class='hs-varid'>unHigh</span></a> <span class='hs-varid'>h</span>
<span class=hs-linenum> 39: </span>
<span class=hs-linenum> 40: </span><span class='hs-comment'>-- | Fills in the aesthetic details to make the candle plot look nice</span>
<span class=hs-linenum> 41: </span><span class='hs-definition'>mkCandlePlot</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>E</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EC</span> <span class='hs-varid'>l2</span> <span class='hs-layout'>(</span><span class='hs-conid'>PlotCandle</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 42: </span><a class=annot href="#"><span class=annottext>[(Graphics.Rendering.Chart.Plot.Candle.Candle a b)] -&gt; (Control.Monad.Trans.State.Lazy.StateT c (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-definition'>mkCandlePlot</span></a> <a class=annot href="#"><span class=annottext>[(Graphics.Rendering.Chart.Plot.Candle.Candle a b)]</span><span class='hs-varid'>cs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ()) -&gt; (Control.Monad.Trans.State.Lazy.StateT c (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>liftEC</span></a> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 43: </span>                 <a class=annot href="#"><span class=annottext>(GHC.Types.Bool -&gt; (Data.Functor.Identity.Identity GHC.Types.Bool)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>plot_candle_fill</span></a> <a class=annot href="#"><span class=annottext>((GHC.Types.Bool -&gt; (Data.Functor.Identity.Identity GHC.Types.Bool)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; GHC.Types.Bool -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <span class='hs-conid'>True</span>
<span class=hs-linenum> 44: </span>                 <a class=annot href="#"><span class=annottext>(Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.FillStyle)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>plot_candle_rise_fill_style</span></a> <a class=annot href="#"><span class=annottext>((Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.FillStyle)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Colour.Internal.AlphaColour GHC.Types.Double) -&gt; Graphics.Rendering.Chart.Backend.Types.FillStyle | v == Graphics.Rendering.Chart.Drawing.solidFillStyle}</span><span class='hs-varid'>solidFillStyle</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double) -&gt; (Data.Colour.Internal.AlphaColour GHC.Types.Double)</span><span class='hs-varid'>opaque</span></a> <a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double)</span><span class='hs-varid'>green</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 45: </span>                 <a class=annot href="#"><span class=annottext>(Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.FillStyle)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>plot_candle_fall_fill_style</span></a> <a class=annot href="#"><span class=annottext>((Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.FillStyle)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{v : (Data.Colour.Internal.AlphaColour GHC.Types.Double) -&gt; Graphics.Rendering.Chart.Backend.Types.FillStyle | v == Graphics.Rendering.Chart.Drawing.solidFillStyle}</span><span class='hs-varid'>solidFillStyle</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double) -&gt; (Data.Colour.Internal.AlphaColour GHC.Types.Double)</span><span class='hs-varid'>opaque</span></a> <a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double)</span><span class='hs-varid'>red</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 46: </span>                 <a class=annot href="#"><span class=annottext>(Graphics.Rendering.Chart.Backend.Types.LineStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.LineStyle)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>plot_candle_line_style</span></a> <a class=annot href="#"><span class=annottext>((Graphics.Rendering.Chart.Backend.Types.LineStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.LineStyle)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; Graphics.Rendering.Chart.Backend.Types.LineStyle -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double -&gt; (Data.Colour.Internal.AlphaColour GHC.Types.Double) -&gt; [GHC.Types.Double] -&gt; Graphics.Rendering.Chart.Backend.Types.LineCap -&gt; Graphics.Rendering.Chart.Backend.Types.LineJoin -&gt; Graphics.Rendering.Chart.Backend.Types.LineStyle | v == Graphics.Rendering.Chart.Backend.Types.LineStyle}</span><span class='hs-conid'>LineStyle</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double) -&gt; (Data.Colour.Internal.AlphaColour GHC.Types.Double)</span><span class='hs-varid'>opaque</span></a> <a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double)</span><span class='hs-varid'>black</span></a><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>LineCapButt</span> <span class='hs-conid'>LineJoinMiter</span>
<span class=hs-linenum> 47: </span>                 <a class=annot href="#"><span class=annottext>(GHC.Types.Double -&gt; (Data.Functor.Identity.Identity GHC.Types.Double)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>plot_candle_tick_length</span></a> <a class=annot href="#"><span class=annottext>((GHC.Types.Double -&gt; (Data.Functor.Identity.Identity GHC.Types.Double)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; GHC.Types.Double -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 48: </span>                 <a class=annot href="#"><span class=annottext>(GHC.Types.Double -&gt; (Data.Functor.Identity.Identity GHC.Types.Double)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>plot_candle_width</span></a> <a class=annot href="#"><span class=annottext>((GHC.Types.Double -&gt; (Data.Functor.Identity.Identity GHC.Types.Double)) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; GHC.Types.Double -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum> 49: </span>                 <a class=annot href="#"><span class=annottext>([(Graphics.Rendering.Chart.Plot.Candle.Candle a b)] -&gt; (Data.Functor.Identity.Identity [(Graphics.Rendering.Chart.Plot.Candle.Candle a b)])) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>plot_candle_values</span></a> <a class=annot href="#"><span class=annottext>(([(Graphics.Rendering.Chart.Plot.Candle.Candle a b)] -&gt; (Data.Functor.Identity.Identity [(Graphics.Rendering.Chart.Plot.Candle.Candle a b)])) -&gt; (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; [(Graphics.Rendering.Chart.Plot.Candle.Candle a b)] -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <span class='hs-varid'>cs</span>
<span class=hs-linenum> 50: </span>
<span class=hs-linenum> 51: </span>
<span class=hs-linenum> 52: </span><span class='hs-definition'>displayCandles</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 53: </span><a class=annot href="#"><span class=annottext>[GHC.Types.Char] -&gt; [Coinbase.Exchange.Types.MarketData.Candle] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>displayCandles</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>fileName</span></a> <a class=annot href="#"><span class=annottext>[Coinbase.Exchange.Types.MarketData.Candle]</span><span class='hs-varid'>candles</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 54: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{v : [(Graphics.Rendering.Chart.Plot.Candle.Candle Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double)] | len v == len candles}</span><span class='hs-varid'>plotPoints</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[Coinbase.Exchange.Types.MarketData.Candle] -&gt; {v : [(Graphics.Rendering.Chart.Plot.Candle.Candle Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double)] | len v == len x1}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.Candle -&gt; (Graphics.Rendering.Chart.Plot.Candle.Candle Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double) | v == Lib.toChartCandle}</span><span class='hs-varid'>toChartCandle</span></a> <span class='hs-varid'>candles</span>
<span class=hs-linenum> 55: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varid'>renderedPlot</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) (Graphics.Rendering.Chart.Plot.Candle.PlotCandle Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double)) -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varid'>plot</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) (Graphics.Rendering.Chart.Plot.Candle.PlotCandle Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double))</span><span class='hs-varid'>mkCandlePlot</span></a> <span class='hs-varid'>plotPoints</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 56: </span>  <a class=annot href="#"><span class=annottext>Graphics.Rendering.Chart.Backend.Diagrams.FileOptions -&gt; [GHC.Types.Char] -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ()) -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>toFile</span></a> <a class=annot href="#"><span class=annottext>Graphics.Rendering.Chart.Backend.Diagrams.FileOptions</span><span class='hs-varid'>def</span></a> <span class='hs-varid'>fileName</span> <span class='hs-varid'>renderedPlot</span>
<span class=hs-linenum> 57: </span>
<span class=hs-linenum> 58: </span>
<span class=hs-linenum> 59: </span><span class='hs-comment'>-- | Delay requests to the api by a bit to make sure computer clock isn't ahead of API clock</span>
<span class=hs-linenum> 60: </span><span class='hs-definition'>apiDelayDuration</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NominalDiffTime</span>
<span class=hs-linenum> 61: </span><a class=annot href="#"><span class=annottext>Data.Time.Clock.UTC.NominalDiffTime</span><span class='hs-definition'>apiDelayDuration</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 10}</span><span class='hs-num'>10</span></a>
<span class=hs-linenum> 62: </span>
<span class=hs-linenum> 63: </span><span class='hs-comment'>-- | Number of candles you want -&gt; candle interval in minutes -&gt; (timestamp interval, granularity)</span>
<span class=hs-linenum> 64: </span><span class='hs-comment'>-- | For example 20 candles with 5 minute candles gives </span>
<span class=hs-linenum> 65: </span><span class='hs-definition'>getCandleRequestParams</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumCandles</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Minutes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 66: </span><a class=annot href="#"><span class=annottext>Types.NumCandles -&gt; Types.Minutes -&gt; (GHC.Types.Int, GHC.Types.Int)</span><span class='hs-definition'>getCandleRequestParams</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>NumCandles</span> <span class='hs-varid'>numCandles</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Minutes</span> <span class='hs-varid'>candleIntervalMinutes</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 67: </span>  <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>numSeconds</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 * x2}</span><span class='hs-varop'>*</span></a> <span class='hs-varid'>numCandles</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>numSeconds</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 68: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 69: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>numSeconds</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == 60}</span><span class='hs-varid'>candleIntervalMinutes</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 * x2}</span><span class='hs-varop'>*</span></a> <span class='hs-num'>60</span>
<span class=hs-linenum> 70: </span>
<span class=hs-linenum> 71: </span><span class='hs-comment'>-- | ExchangeConf: which exchange to run request on</span>
<span class=hs-linenum> 72: </span><span class='hs-comment'>-- | NumCandles: number of candles to get</span>
<span class=hs-linenum> 73: </span><span class='hs-comment'>-- | Minutes: duration of each candle</span>
<span class=hs-linenum> 74: </span><span class='hs-comment'>-- | For example you could say `getMostRecentCandles liveConfig (NumCandles 30) (Minutes 2)`</span>
<span class=hs-linenum> 75: </span><span class='hs-comment'>-- | Which would give the 30 most recent candles each spanning two minutes over a total of an hour long window</span>
<span class=hs-linenum> 76: </span><span class='hs-definition'>getMostRecentCandles</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ExchangeConf</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NumCandles</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Minutes</span>
<span class=hs-linenum> 77: </span>                     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span><span class='hs-varop'>.</span><span class='hs-conid'>ExchangeFailure</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 78: </span><a class=annot href="#"><span class=annottext>Coinbase.Exchange.Types.ExchangeConf -&gt; Types.NumCandles -&gt; Types.Minutes -&gt; (GHC.Types.IO (Data.Either.Either Coinbase.Exchange.Types.ExchangeFailure [Coinbase.Exchange.Types.MarketData.Candle]))</span><span class='hs-definition'>getMostRecentCandles</span></a> <a class=annot href="#"><span class=annottext>Coinbase.Exchange.Types.ExchangeConf</span><span class='hs-varid'>conf</span></a> <a class=annot href="#"><span class=annottext>Types.NumCandles</span><span class='hs-varid'>numCandles</span></a> <a class=annot href="#"><span class=annottext>Types.Minutes</span><span class='hs-varid'>candleIntervalMinutes</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 79: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>timeWindow</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>granularity</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Types.NumCandles -&gt; Types.Minutes -&gt; (GHC.Types.Int, GHC.Types.Int) | v == Lib.getCandleRequestParams}</span><span class='hs-varid'>getCandleRequestParams</span></a> <span class='hs-varid'>numCandles</span> <span class='hs-varid'>candleIntervalMinutes</span>
<span class=hs-linenum> 80: </span>  <a class=annot href="#"><span class=annottext>Data.Time.Clock.UTC.UTCTime</span><span class='hs-varid'>endTime</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO Data.Time.Clock.UTC.UTCTime)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : Data.Time.Clock.UTC.NominalDiffTime -&gt; Data.Time.Clock.UTC.UTCTime -&gt; Data.Time.Clock.UTC.UTCTime | v == Data.Time.Clock.UTCDiff.addUTCTime}</span><span class='hs-varid'>addUTCTime</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : Data.Time.Clock.UTC.NominalDiffTime | v == (-Lib.apiDelayDuration)}</span><span class='hs-comment'>-</span></a><span class='hs-varid'>apiDelayDuration</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(Data.Time.Clock.UTC.UTCTime -&gt; Data.Time.Clock.UTC.UTCTime) -&gt; (GHC.Types.IO Data.Time.Clock.UTC.UTCTime) -&gt; (GHC.Types.IO Data.Time.Clock.UTC.UTCTime)</span><span class='hs-varop'>&lt;$&gt;</span></a> <span class='hs-varid'>getCurrentTime</span>
<span class=hs-linenum> 81: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Time.Clock.UTC.UTCTime</span><span class='hs-varid'>startTime</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Data.Time.Clock.UTC.NominalDiffTime -&gt; Data.Time.Clock.UTC.UTCTime -&gt; Data.Time.Clock.UTC.UTCTime | v == Data.Time.Clock.UTCDiff.addUTCTime}</span><span class='hs-varid'>addUTCTime</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; Data.Time.Clock.UTC.NominalDiffTime</span><span class='hs-varid'>realToFrac</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (-timeWindow)}</span><span class='hs-comment'>-</span></a><span class='hs-varid'>timeWindow</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>endTime</span>
<span class=hs-linenum> 82: </span>  <a class=annot href="#"><span class=annottext>(Coinbase.Exchange.Types.ExchangeT GHC.Types.IO [Coinbase.Exchange.Types.MarketData.Candle]) -&gt; (GHC.Types.IO (Data.Either.Either Coinbase.Exchange.Types.ExchangeFailure [Coinbase.Exchange.Types.MarketData.Candle]))</span><span class='hs-varid'>runExchange</span></a> <span class='hs-varid'>conf</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>Coinbase.Exchange.Types.Core.ProductId -&gt; (GHC.Base.Maybe Data.Time.Clock.UTC.UTCTime) -&gt; (GHC.Base.Maybe Data.Time.Clock.UTC.UTCTime) -&gt; (GHC.Base.Maybe GHC.Types.Int) -&gt; (Coinbase.Exchange.Types.ExchangeT GHC.Types.IO [Coinbase.Exchange.Types.MarketData.Candle])</span><span class='hs-varid'>getHistory</span></a>
<span class=hs-linenum> 83: </span>                          <span class='hs-varid'>ethUSDticker</span>
<span class=hs-linenum> 84: </span>                          <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>startTime</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 85: </span>                          <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>endTime</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 86: </span>                          <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>granularity</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 87: </span>    
<span class=hs-linenum> 88: </span><span class='hs-definition'>ema</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EMA</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EMA</span>
<span class=hs-linenum> 89: </span><a class=annot href="#"><span class=annottext>Lib.EMA -&gt; [Coinbase.Exchange.Types.MarketData.Candle] -&gt; Lib.EMA</span><span class='hs-definition'>ema</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>EMA</span> <span class='hs-varid'>prevEMA</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>[Coinbase.Exchange.Types.MarketData.Candle]</span><span class='hs-varid'>candles</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>candle</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; Lib.EMA | v == Lib.EMA}</span><span class='hs-conid'>EMA</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.Candle -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == Lib.getClosePrice}</span><span class='hs-varid'>getClosePrice</span></a> <span class='hs-varid'>candle</span> <a class=annot href="#"><span class=annottext>x1:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; x2:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x1 - x2}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>prevEMA</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>x1:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; x2:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x1 * x2}</span><span class='hs-varop'>*</span></a> <span class='hs-varid'>multiplier</span> <a class=annot href="#"><span class=annottext>x1:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; x2:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <span class='hs-varid'>prevEMA</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 90: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 91: </span>    <span class='hs-varid'>multiplier</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum> 92: </span>    <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>multiplier</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>toRational</span></a> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>x1:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; x2:{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v /= 0
                                                                                                    &amp;&amp; v /= 0.0} -&gt; {v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x1 / x2
                                                                                                                                                                     &amp;&amp; v == x1 / x2}</span><span class='hs-varop'>/</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>toRational</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>xs:[Coinbase.Exchange.Types.MarketData.Candle] -&gt; {v : GHC.Types.Int | v &gt;= 0
                                                                       &amp;&amp; v == len xs}</span><span class='hs-varid'>length</span></a> <span class='hs-varid'>candles</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>x1:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; x2:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span><span class='hs-comment'>-- Not sure what the difference between ratio and rational are and when I should use which ?</span>
<span class=hs-linenum> 95: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>SMA</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SMA</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum> 96: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Show.Show Lib.SMA)</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Lib.SMA)</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Num.Num Lib.SMA)</span><span class='hs-conid'>Num</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 97: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>EMA</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EMA</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum> 98: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Show.Show Lib.EMA)</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq Lib.EMA)</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Num.Num Lib.EMA)</span><span class='hs-conid'>Num</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-definition'>getClosePrice</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CoinbaseCandle</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum>101: </span><a class=annot href="#"><span class=annottext>Coinbase.Exchange.Types.MarketData.Candle -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>getClosePrice</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>MarketData</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>utcTime</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>o</span> <span class='hs-varid'>c</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>toRational</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.Close -&gt; GHC.Types.Double | v == Coinbase.Exchange.Types.MarketData.unClose}</span><span class='hs-varid'>unClose</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-definition'>sma</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SMA</span>
<span class=hs-linenum>104: </span><a class=annot href="#"><span class=annottext>[Coinbase.Exchange.Types.MarketData.Candle] -&gt; Lib.SMA</span><span class='hs-definition'>sma</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; Lib.SMA | v == Lib.SMA}</span><span class='hs-conid'>SMA</span></a> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>0</span></a> 
<span class=hs-linenum>105: </span><span class='hs-definition'>sma</span> <span class='hs-varid'>candles</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; Lib.SMA | v == Lib.SMA}</span><span class='hs-conid'>SMA</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : [Coinbase.Exchange.Types.MarketData.Candle] -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == totalSum}</span><span class='hs-varid'>totalSum</span></a> <span class='hs-varid'>candles</span> <a class=annot href="#"><span class=annottext>x1:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; x2:{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v /= 0
                                                                                                    &amp;&amp; v /= 0.0} -&gt; {v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x1 / x2
                                                                                                                                                                     &amp;&amp; v == x1 / x2}</span><span class='hs-varop'>/</span></a> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>numCandles</span></a> <span class='hs-varid'>candles</span><span class='hs-layout'>)</span>
<span class=hs-linenum>106: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>107: </span>    <a class=annot href="#"><span class=annottext>[Coinbase.Exchange.Types.MarketData.Candle] -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>totalSum</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>[(GHC.Real.Ratio GHC.Integer.Type.Integer)] -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>sum</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>x1:[Coinbase.Exchange.Types.MarketData.Candle] -&gt; {v : [(GHC.Real.Ratio GHC.Integer.Type.Integer)] | len v == len x1}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>{v : Coinbase.Exchange.Types.MarketData.Candle -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == Lib.getClosePrice}</span><span class='hs-varid'>getClosePrice</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>108: </span>    <a class=annot href="#"><span class=annottext>[a] -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>numCandles</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; {v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x1}</span><span class='hs-varid'>fromIntegral</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>xs:[a] -&gt; {v : GHC.Types.Int | v &gt;= 0
                               &amp;&amp; v == len xs}</span><span class='hs-varid'>length</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>109: </span>    
</pre>
</body>
</html>