<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/Users/rushishah/work/beginners-luck/src/Lib.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span></a>
<span class=hs-linenum>  2: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Lib</span>
<span class=hs-linenum>  3: </span>    <span class='hs-layout'>(</span> <span class='hs-varid'>getMostRecentCandles</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  4: </span>      <span class='hs-varid'>displayCandles</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  5: </span>      <span class='hs-varid'>sma</span>
<span class=hs-linenum>  6: </span>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>-- Coinbase stuff</span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>MarketData</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<span class=hs-linenum> 11: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span><span class='hs-varop'>.</span><span class='hs-conid'>Core</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>-- Clock stuff</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Time</span><span class='hs-varop'>.</span><span class='hs-conid'>Clock</span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Time</span><span class='hs-varop'>.</span><span class='hs-conid'>LocalTime</span>
<span class=hs-linenum> 16: </span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>-- Graphics stuff</span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>Chart</span><span class='hs-varop'>.</span><span class='hs-conid'>Easy</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>E</span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>Chart</span><span class='hs-varop'>.</span><span class='hs-conid'>Backend</span><span class='hs-varop'>.</span><span class='hs-conid'>Diagrams</span> <span class='hs-layout'>(</span><span class='hs-varid'>toFile</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 20: </span>
<span class=hs-linenum> 21: </span><span class='hs-comment'>-- Haskell stuff</span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Ratio</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>-- Beginners luck stuff</span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Types</span>
<span class=hs-linenum> 26: </span>
<span class=hs-linenum> 27: </span><span class='hs-comment'>-- | Converts from the candle type given by the API to the candle type needed for the chart</span>
<span class=hs-linenum> 28: </span><span class='hs-definition'>toChartCandle</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CoinbaseCandle</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>E</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-conid'>LocalTime</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum> 29: </span><a class=annot href="#"><span class=annottext>ds_dz7D:{VV##5428 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##5430" | $k_##5429} -&gt; {VV##5438 : (Graphics.Rendering.Chart.Plot.Candle.Candle {VV##5432 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5434" | $k_##5433} {VV##5435 : GHC.Types.Double^"lq_tmp$x##5437" | $k_##5436})^"lq_tmp$x##5440" | $k_##5439}</span><span class='hs-definition'>toChartCandle</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>MarketData</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>utcTime</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>o</span> <span class='hs-varid'>c</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> 
<span class=hs-linenum> 30: </span>  <a class=annot href="#"><span class=annottext>lq_tmp$x##5576:{lq_tmp$x##5588 : GHC.Types.Double^"lq_tmp$x##5587" "lq_tmp$x##760" | $k_##5586[lq_tmp$x##5575:=time##atVd][VV##5585:=lq_tmp$x##5588]} -&gt; lq_tmp$x##5577:{lq_tmp$x##5588 : GHC.Types.Double^"lq_tmp$x##5587" "lq_tmp$x##762" | $k_##5586[lq_tmp$x##5575:=time##atVd][VV##5585:=lq_tmp$x##5588]} -&gt; lq_tmp$x##5578:{lq_tmp$x##5588 : GHC.Types.Double^"lq_tmp$x##5587" "lq_tmp$x##764" | $k_##5586[lq_tmp$x##5575:=time##atVd][VV##5585:=lq_tmp$x##5588]} -&gt; lq_tmp$x##5579:{lq_tmp$x##5588 : GHC.Types.Double^"lq_tmp$x##5587" "lq_tmp$x##766" | $k_##5586[lq_tmp$x##5575:=time##atVd][VV##5585:=lq_tmp$x##5588]} -&gt; lq_tmp$x##5580:{lq_tmp$x##5588 : GHC.Types.Double^"lq_tmp$x##5587" "lq_tmp$x##768" | $k_##5586[lq_tmp$x##5575:=time##atVd][VV##5585:=lq_tmp$x##5588]} -&gt; (Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##5584 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5583" "lq_tmp$x##769" | $k_##5582[VV##5581:=lq_tmp$x##5584][lq_tmp$x##5575:=time##atVd]} {lq_tmp$x##5588 : GHC.Types.Double^"lq_tmp$x##5587" "lq_tmp$x##770" | $k_##5586[lq_tmp$x##5575:=time##atVd][VV##5585:=lq_tmp$x##5588]})</span><span class='hs-conid'>E</span></a><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>time</span> <span class='hs-varid'>low</span> <span class='hs-varid'>open</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5554 : GHC.Types.Double^"lq_tmp$x##5553" | lq_tmp$x##5554 == lq_anf$##7205759403792929029##dzel / lq_anf$##7205759403792929030##dzem
                                                      &amp;&amp; lq_tmp$x##5554 == lq_anf$##7205759403792929029##dzel / lq_anf$##7205759403792929030##dzem}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##5530 : GHC.Types.Double^"lq_tmp$x##5529" | lq_tmp$x##5530 == open##atVf + close##atVg}</span><span class='hs-varid'>open</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##5527:GHC.Types.Double -&gt; lq_tmp$x##5528:GHC.Types.Double -&gt; {lq_tmp$x##5530 : GHC.Types.Double^"lq_tmp$x##5529" | lq_tmp$x##5530 == lq_tmp$x##5527 + lq_tmp$x##5528}</span><span class='hs-varop'>+</span></a> <span class='hs-varid'>close</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5551:GHC.Types.Double -&gt; lq_tmp$x##5552:{lq_tmp$x##5554 : GHC.Types.Double^"lq_tmp$x##5553" | lq_tmp$x##5554 /= 0
                                                                                                        &amp;&amp; lq_tmp$x##5554 /= 0.0} -&gt; {lq_tmp$x##5554 : GHC.Types.Double^"lq_tmp$x##5553" | lq_tmp$x##5554 == lq_tmp$x##5551 / lq_tmp$x##5552
                                                                                                                                                                                           &amp;&amp; lq_tmp$x##5554 == lq_tmp$x##5551 / lq_tmp$x##5552}</span><span class='hs-varop'>/</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5537 : GHC.Types.Double | lq_tmp$x##5537 == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-varid'>close</span> <span class='hs-varid'>high</span>
<span class=hs-linenum> 31: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 32: </span>    <span class='hs-comment'>-- | Convert a UTCTime to a LocalTime with the default time zone</span>
<span class=hs-linenum> 33: </span>    <a class=annot href="#"><span class=annottext>Data.Time.LocalTime.LocalTime.LocalTime</span><span class='hs-varid'>time</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5512 : lq_tmp$x##5513:Data.Time.LocalTime.TimeZone.TimeZone -&gt; lq_tmp$x##5514:Data.Time.Clock.UTC.UTCTime -&gt; Data.Time.LocalTime.LocalTime.LocalTime | lq_tmp$x##5512 == Data.Time.LocalTime.LocalTime.utcToLocalTime}</span><span class='hs-varid'>utcToLocalTime</span></a> <span class='hs-varid'>utc</span> <span class='hs-varid'>utcTime</span>
<span class=hs-linenum> 34: </span>    <span class='hs-comment'>-- | Extract values from their type wrappers</span>
<span class=hs-linenum> 35: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>low</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5504 : lq_tmp$x##5505:Coinbase.Exchange.Types.MarketData.Low -&gt; GHC.Types.Double | lq_tmp$x##5504 == Coinbase.Exchange.Types.MarketData.unLow}</span><span class='hs-varid'>unLow</span></a> <span class='hs-varid'>l</span>
<span class=hs-linenum> 36: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>open</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5498 : lq_tmp$x##5499:Coinbase.Exchange.Types.MarketData.Open -&gt; GHC.Types.Double | lq_tmp$x##5498 == Coinbase.Exchange.Types.MarketData.unOpen}</span><span class='hs-varid'>unOpen</span></a> <span class='hs-varid'>o</span>
<span class=hs-linenum> 37: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>close</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5492 : lq_tmp$x##5493:Coinbase.Exchange.Types.MarketData.Close -&gt; GHC.Types.Double | lq_tmp$x##5492 == Coinbase.Exchange.Types.MarketData.unClose}</span><span class='hs-varid'>unClose</span></a> <span class='hs-varid'>c</span>
<span class=hs-linenum> 38: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>high</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5486 : lq_tmp$x##5487:Coinbase.Exchange.Types.MarketData.High -&gt; GHC.Types.Double | lq_tmp$x##5486 == Coinbase.Exchange.Types.MarketData.unHigh}</span><span class='hs-varid'>unHigh</span></a> <span class='hs-varid'>h</span>
<span class=hs-linenum> 39: </span>
<span class=hs-linenum> 40: </span><span class='hs-comment'>-- | Fills in the aesthetic details to make the candle plot look nice</span>
<span class=hs-linenum> 41: </span><span class='hs-definition'>mkCandlePlot</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>E</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EC</span> <span class='hs-varid'>l2</span> <span class='hs-layout'>(</span><span class='hs-conid'>PlotCandle</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 42: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3688:{VV##3708 : [{VV##3695 : (Graphics.Rendering.Chart.Plot.Candle.Candle {VV##3689 : a^"lq_tmp$x##3691" | $k_##3690} {VV##3692 : b^"lq_tmp$x##3694" | $k_##3693})^"lq_tmp$x##3697" | $k_##3696}]^"lq_tmp$x##3710" | $k_##3709} -&gt; {VV##3732 : (Control.Monad.Trans.State.Lazy.StateT {VV##3711 : l2^"lq_tmp$x##3713" | $k_##3712} {VV##3720 : (Control.Monad.Trans.State.Lazy.StateT {VV##3714 : Graphics.Rendering.Chart.State.CState^"lq_tmp$x##3716" | $k_##3715} {VV##3717 : Data.Functor.Identity.Identity^"lq_tmp$x##3719" | $k_##3718})^"lq_tmp$x##3722" | $k_##3721} {VV##3729 : (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {VV##3723 : a^"lq_tmp$x##3725" | $k_##3724} {VV##3726 : b^"lq_tmp$x##3728" | $k_##3727})^"lq_tmp$x##3731" | $k_##3730})^"lq_tmp$x##3734" | $k_##3733}</span><span class='hs-definition'>mkCandlePlot</span></a> <a class=annot href="#"><span class=annottext>{VV##3708 : [{VV##3695 : (Graphics.Rendering.Chart.Plot.Candle.Candle {VV##3689 : a^"lq_tmp$x##3691" | $k_##3690} {VV##3692 : b^"lq_tmp$x##3694" | $k_##3693})^"lq_tmp$x##3697" | $k_##3696}]^"lq_tmp$x##3710" | $k_##3709}</span><span class='hs-varid'>cs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3828:(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) {lq_tmp$x##3838 : ()^"lq_tmp$x##3837" "lq_tmp$x##545" | $k_##3836[lq_tmp$x##3827:=lq_anf$##7205759403792928993##dzdL][VV##3835:=lq_tmp$x##3838]}) -&gt; (Control.Monad.Trans.State.Lazy.StateT {lq_tmp$x##3842 : l2^"lq_tmp$x##3841" "lq_tmp$x##547" | $k_##3840[VV##3839:=lq_tmp$x##3842][lq_tmp$x##3827:=lq_anf$##7205759403792928993##dzdL]} (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))</span><span class='hs-varid'>liftEC</span></a> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 43: </span>                 <a class=annot href="#"><span class=annottext>lq_tmp$x##3868:(lq_tmp$x##3866:GHC.Types.Bool -&gt; (Data.Functor.Identity.Identity GHC.Types.Bool)) -&gt; lq_tmp$x##3869:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##3873 : a^"lq_tmp$x##3872" "lq_tmp$x##648" | $k_##3871[lq_tmp$x##3867:=Data.Functor.Identity.$fFunctorIdentity][VV##3870:=lq_tmp$x##3873]} {lq_tmp$x##3877 : b^"lq_tmp$x##3876" "lq_tmp$x##649" | $k_##3875[VV##3874:=lq_tmp$x##3877][lq_tmp$x##3867:=Data.Functor.Identity.$fFunctorIdentity]}) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##3873 : a^"lq_tmp$x##3872" "lq_tmp$x##652" | $k_##3871[lq_tmp$x##3867:=Data.Functor.Identity.$fFunctorIdentity][VV##3870:=lq_tmp$x##3873]} {lq_tmp$x##3877 : b^"lq_tmp$x##3876" "lq_tmp$x##653" | $k_##3875[VV##3874:=lq_tmp$x##3877][lq_tmp$x##3867:=Data.Functor.Identity.$fFunctorIdentity]}))</span><span class='hs-varid'>plot_candle_fill</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3906:(lq_tmp$x##3903:(lq_tmp$x##3902:{lq_tmp$x##3931 : GHC.Types.Bool^"lq_tmp$x##3930" "lq_tmp$x##483" | $k_##3929[VV##3928:=lq_tmp$x##3931][lq_tmp$x##3905:=fix$36$$36$dMonadState_axpm]} -&gt; (Data.Functor.Identity.Identity {lq_tmp$x##3935 : GHC.Types.Bool^"lq_tmp$x##3934" "lq_tmp$x##484" | $k_##3933[VV##3932:=lq_tmp$x##3935][lq_tmp$x##3905:=fix$36$$36$dMonadState_axpm]})) -&gt; lq_tmp$x##3904:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; lq_tmp$x##3907:{lq_tmp$x##3935 : GHC.Types.Bool^"lq_tmp$x##3934" "lq_tmp$x##491" | $k_##3933[VV##3932:=lq_tmp$x##3935][lq_tmp$x##3905:=fix$36$$36$dMonadState_axpm]} -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <span class='hs-conid'>True</span>
<span class=hs-linenum> 44: </span>                 <a class=annot href="#"><span class=annottext>lq_tmp$x##3985:(lq_tmp$x##3983:Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.FillStyle)) -&gt; lq_tmp$x##3986:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##3990 : a^"lq_tmp$x##3989" "lq_tmp$x##618" | $k_##3988[VV##3987:=lq_tmp$x##3990][lq_tmp$x##3984:=Data.Functor.Identity.$fFunctorIdentity]} {lq_tmp$x##3994 : b^"lq_tmp$x##3993" "lq_tmp$x##619" | $k_##3992[VV##3991:=lq_tmp$x##3994][lq_tmp$x##3984:=Data.Functor.Identity.$fFunctorIdentity]}) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##3990 : a^"lq_tmp$x##3989" "lq_tmp$x##622" | $k_##3988[VV##3987:=lq_tmp$x##3990][lq_tmp$x##3984:=Data.Functor.Identity.$fFunctorIdentity]} {lq_tmp$x##3994 : b^"lq_tmp$x##3993" "lq_tmp$x##623" | $k_##3992[VV##3991:=lq_tmp$x##3994][lq_tmp$x##3984:=Data.Functor.Identity.$fFunctorIdentity]}))</span><span class='hs-varid'>plot_candle_rise_fill_style</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4065:(lq_tmp$x##4062:(lq_tmp$x##4061:{lq_tmp$x##4090 : Graphics.Rendering.Chart.Backend.Types.FillStyle^"lq_tmp$x##4089" "lq_tmp$x##483" | $k_##4088[lq_tmp$x##4064:=fix$36$$36$dMonadState_axpm][VV##4087:=lq_tmp$x##4090]} -&gt; (Data.Functor.Identity.Identity {lq_tmp$x##4094 : Graphics.Rendering.Chart.Backend.Types.FillStyle^"lq_tmp$x##4093" "lq_tmp$x##484" | $k_##4092[lq_tmp$x##4064:=fix$36$$36$dMonadState_axpm][VV##4091:=lq_tmp$x##4094]})) -&gt; lq_tmp$x##4063:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; lq_tmp$x##4066:{lq_tmp$x##4094 : Graphics.Rendering.Chart.Backend.Types.FillStyle^"lq_tmp$x##4093" "lq_tmp$x##491" | $k_##4092[lq_tmp$x##4064:=fix$36$$36$dMonadState_axpm][VV##4091:=lq_tmp$x##4094]} -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4037 : lq_tmp$x##4038:(Data.Colour.Internal.AlphaColour GHC.Types.Double) -&gt; Graphics.Rendering.Chart.Backend.Types.FillStyle | lq_tmp$x##4037 == Graphics.Rendering.Chart.Drawing.solidFillStyle}</span><span class='hs-varid'>solidFillStyle</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##4026:(Data.Colour.Internal.Colour GHC.Types.Double) -&gt; (Data.Colour.Internal.AlphaColour GHC.Types.Double)</span><span class='hs-varid'>opaque</span></a> <a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double)</span><span class='hs-varid'>green</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 45: </span>                 <a class=annot href="#"><span class=annottext>lq_tmp$x##4144:(lq_tmp$x##4142:Graphics.Rendering.Chart.Backend.Types.FillStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.FillStyle)) -&gt; lq_tmp$x##4145:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4149 : a^"lq_tmp$x##4148" "lq_tmp$x##663" | $k_##4147[VV##4146:=lq_tmp$x##4149][lq_tmp$x##4143:=Data.Functor.Identity.$fFunctorIdentity]} {lq_tmp$x##4153 : b^"lq_tmp$x##4152" "lq_tmp$x##664" | $k_##4151[VV##4150:=lq_tmp$x##4153][lq_tmp$x##4143:=Data.Functor.Identity.$fFunctorIdentity]}) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4149 : a^"lq_tmp$x##4148" "lq_tmp$x##667" | $k_##4147[VV##4146:=lq_tmp$x##4149][lq_tmp$x##4143:=Data.Functor.Identity.$fFunctorIdentity]} {lq_tmp$x##4153 : b^"lq_tmp$x##4152" "lq_tmp$x##668" | $k_##4151[VV##4150:=lq_tmp$x##4153][lq_tmp$x##4143:=Data.Functor.Identity.$fFunctorIdentity]}))</span><span class='hs-varid'>plot_candle_fall_fill_style</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4224:(lq_tmp$x##4221:(lq_tmp$x##4220:{lq_tmp$x##4249 : Graphics.Rendering.Chart.Backend.Types.FillStyle^"lq_tmp$x##4248" "lq_tmp$x##483" | $k_##4247[VV##4246:=lq_tmp$x##4249][lq_tmp$x##4223:=fix$36$$36$dMonadState_axpm]} -&gt; (Data.Functor.Identity.Identity {lq_tmp$x##4253 : Graphics.Rendering.Chart.Backend.Types.FillStyle^"lq_tmp$x##4252" "lq_tmp$x##484" | $k_##4251[VV##4250:=lq_tmp$x##4253][lq_tmp$x##4223:=fix$36$$36$dMonadState_axpm]})) -&gt; lq_tmp$x##4222:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; lq_tmp$x##4225:{lq_tmp$x##4253 : Graphics.Rendering.Chart.Backend.Types.FillStyle^"lq_tmp$x##4252" "lq_tmp$x##491" | $k_##4251[VV##4250:=lq_tmp$x##4253][lq_tmp$x##4223:=fix$36$$36$dMonadState_axpm]} -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4196 : lq_tmp$x##4197:(Data.Colour.Internal.AlphaColour GHC.Types.Double) -&gt; Graphics.Rendering.Chart.Backend.Types.FillStyle | lq_tmp$x##4196 == Graphics.Rendering.Chart.Drawing.solidFillStyle}</span><span class='hs-varid'>solidFillStyle</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##4185:(Data.Colour.Internal.Colour GHC.Types.Double) -&gt; (Data.Colour.Internal.AlphaColour GHC.Types.Double)</span><span class='hs-varid'>opaque</span></a> <a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double)</span><span class='hs-varid'>red</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 46: </span>                 <a class=annot href="#"><span class=annottext>lq_tmp$x##4303:(lq_tmp$x##4301:Graphics.Rendering.Chart.Backend.Types.LineStyle -&gt; (Data.Functor.Identity.Identity Graphics.Rendering.Chart.Backend.Types.LineStyle)) -&gt; lq_tmp$x##4304:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4308 : a^"lq_tmp$x##4307" "lq_tmp$x##633" | $k_##4306[lq_tmp$x##4302:=Data.Functor.Identity.$fFunctorIdentity][VV##4305:=lq_tmp$x##4308]} {lq_tmp$x##4312 : b^"lq_tmp$x##4311" "lq_tmp$x##634" | $k_##4310[lq_tmp$x##4302:=Data.Functor.Identity.$fFunctorIdentity][VV##4309:=lq_tmp$x##4312]}) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4308 : a^"lq_tmp$x##4307" "lq_tmp$x##637" | $k_##4306[lq_tmp$x##4302:=Data.Functor.Identity.$fFunctorIdentity][VV##4305:=lq_tmp$x##4308]} {lq_tmp$x##4312 : b^"lq_tmp$x##4311" "lq_tmp$x##638" | $k_##4310[lq_tmp$x##4302:=Data.Functor.Identity.$fFunctorIdentity][VV##4309:=lq_tmp$x##4312]}))</span><span class='hs-varid'>plot_candle_line_style</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4423:(lq_tmp$x##4420:(lq_tmp$x##4419:{lq_tmp$x##4448 : Graphics.Rendering.Chart.Backend.Types.LineStyle^"lq_tmp$x##4447" "lq_tmp$x##483" | $k_##4446[lq_tmp$x##4422:=fix$36$$36$dMonadState_axpm][VV##4445:=lq_tmp$x##4448]} -&gt; (Data.Functor.Identity.Identity {lq_tmp$x##4452 : Graphics.Rendering.Chart.Backend.Types.LineStyle^"lq_tmp$x##4451" "lq_tmp$x##484" | $k_##4450[VV##4449:=lq_tmp$x##4452][lq_tmp$x##4422:=fix$36$$36$dMonadState_axpm]})) -&gt; lq_tmp$x##4421:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; lq_tmp$x##4424:{lq_tmp$x##4452 : Graphics.Rendering.Chart.Backend.Types.LineStyle^"lq_tmp$x##4451" "lq_tmp$x##491" | $k_##4450[VV##4449:=lq_tmp$x##4452][lq_tmp$x##4422:=fix$36$$36$dMonadState_axpm]} -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4381 : lq_tmp$x##4383:GHC.Types.Double -&gt; lq_tmp$x##4384:(Data.Colour.Internal.AlphaColour GHC.Types.Double) -&gt; lq_tmp$x##4385:[GHC.Types.Double] -&gt; lq_tmp$x##4386:Graphics.Rendering.Chart.Backend.Types.LineCap -&gt; lq_tmp$x##4387:Graphics.Rendering.Chart.Backend.Types.LineJoin -&gt; Graphics.Rendering.Chart.Backend.Types.LineStyle | lq_tmp$x##4381 == Graphics.Rendering.Chart.Backend.Types.LineStyle}</span><span class='hs-conid'>LineStyle</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4319 : GHC.Types.Double | lq_tmp$x##4319 == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##4344:(Data.Colour.Internal.Colour GHC.Types.Double) -&gt; (Data.Colour.Internal.AlphaColour GHC.Types.Double)</span><span class='hs-varid'>opaque</span></a> <a class=annot href="#"><span class=annottext>(Data.Colour.Internal.Colour GHC.Types.Double)</span><span class='hs-varid'>black</span></a><span class='hs-layout'>)</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>LineCapButt</span> <span class='hs-conid'>LineJoinMiter</span>
<span class=hs-linenum> 47: </span>                 <a class=annot href="#"><span class=annottext>lq_tmp$x##4502:(lq_tmp$x##4500:GHC.Types.Double -&gt; (Data.Functor.Identity.Identity GHC.Types.Double)) -&gt; lq_tmp$x##4503:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4507 : a^"lq_tmp$x##4506" "lq_tmp$x##603" | $k_##4505[lq_tmp$x##4501:=Data.Functor.Identity.$fFunctorIdentity][VV##4504:=lq_tmp$x##4507]} {lq_tmp$x##4511 : b^"lq_tmp$x##4510" "lq_tmp$x##604" | $k_##4509[VV##4508:=lq_tmp$x##4511][lq_tmp$x##4501:=Data.Functor.Identity.$fFunctorIdentity]}) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4507 : a^"lq_tmp$x##4506" "lq_tmp$x##607" | $k_##4505[lq_tmp$x##4501:=Data.Functor.Identity.$fFunctorIdentity][VV##4504:=lq_tmp$x##4507]} {lq_tmp$x##4511 : b^"lq_tmp$x##4510" "lq_tmp$x##608" | $k_##4509[VV##4508:=lq_tmp$x##4511][lq_tmp$x##4501:=Data.Functor.Identity.$fFunctorIdentity]}))</span><span class='hs-varid'>plot_candle_tick_length</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4546:(lq_tmp$x##4543:(lq_tmp$x##4542:{lq_tmp$x##4571 : GHC.Types.Double^"lq_tmp$x##4570" "lq_tmp$x##483" | $k_##4569[VV##4568:=lq_tmp$x##4571][lq_tmp$x##4545:=fix$36$$36$dMonadState_axpm]} -&gt; (Data.Functor.Identity.Identity {lq_tmp$x##4575 : GHC.Types.Double^"lq_tmp$x##4574" "lq_tmp$x##484" | $k_##4573[VV##4572:=lq_tmp$x##4575][lq_tmp$x##4545:=fix$36$$36$dMonadState_axpm]})) -&gt; lq_tmp$x##4544:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; lq_tmp$x##4547:{lq_tmp$x##4575 : GHC.Types.Double^"lq_tmp$x##4574" "lq_tmp$x##491" | $k_##4573[VV##4572:=lq_tmp$x##4575][lq_tmp$x##4545:=fix$36$$36$dMonadState_axpm]} -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4518 : GHC.Types.Double | lq_tmp$x##4518 == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 48: </span>                 <a class=annot href="#"><span class=annottext>lq_tmp$x##4625:(lq_tmp$x##4623:GHC.Types.Double -&gt; (Data.Functor.Identity.Identity GHC.Types.Double)) -&gt; lq_tmp$x##4626:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4630 : a^"lq_tmp$x##4629" "lq_tmp$x##561" | $k_##4628[lq_tmp$x##4624:=Data.Functor.Identity.$fFunctorIdentity][VV##4627:=lq_tmp$x##4630]} {lq_tmp$x##4634 : b^"lq_tmp$x##4633" "lq_tmp$x##562" | $k_##4632[VV##4631:=lq_tmp$x##4634][lq_tmp$x##4624:=Data.Functor.Identity.$fFunctorIdentity]}) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4630 : a^"lq_tmp$x##4629" "lq_tmp$x##565" | $k_##4628[lq_tmp$x##4624:=Data.Functor.Identity.$fFunctorIdentity][VV##4627:=lq_tmp$x##4630]} {lq_tmp$x##4634 : b^"lq_tmp$x##4633" "lq_tmp$x##566" | $k_##4632[VV##4631:=lq_tmp$x##4634][lq_tmp$x##4624:=Data.Functor.Identity.$fFunctorIdentity]}))</span><span class='hs-varid'>plot_candle_width</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4669:(lq_tmp$x##4666:(lq_tmp$x##4665:{lq_tmp$x##4694 : GHC.Types.Double^"lq_tmp$x##4693" "lq_tmp$x##483" | $k_##4692[lq_tmp$x##4668:=fix$36$$36$dMonadState_axpm][VV##4691:=lq_tmp$x##4694]} -&gt; (Data.Functor.Identity.Identity {lq_tmp$x##4698 : GHC.Types.Double^"lq_tmp$x##4697" "lq_tmp$x##484" | $k_##4696[lq_tmp$x##4668:=fix$36$$36$dMonadState_axpm][VV##4695:=lq_tmp$x##4698]})) -&gt; lq_tmp$x##4667:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; lq_tmp$x##4670:{lq_tmp$x##4698 : GHC.Types.Double^"lq_tmp$x##4697" "lq_tmp$x##491" | $k_##4696[lq_tmp$x##4668:=fix$36$$36$dMonadState_axpm][VV##4695:=lq_tmp$x##4698]} -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4641 : GHC.Types.Double | lq_tmp$x##4641 == 2.0}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum> 49: </span>                 <a class=annot href="#"><span class=annottext>lq_tmp$x##4765:(lq_tmp$x##4761:[(Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##4772 : a^"lq_tmp$x##4771" "lq_tmp$x##572" | $k_##4770[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4769:=lq_tmp$x##4772]} {lq_tmp$x##4776 : b^"lq_tmp$x##4775" "lq_tmp$x##573" | $k_##4774[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4773:=lq_tmp$x##4776]})] -&gt; (Data.Functor.Identity.Identity [(Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##4780 : a^"lq_tmp$x##4779" "lq_tmp$x##580" | $k_##4778[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4777:=lq_tmp$x##4780]} {lq_tmp$x##4784 : b^"lq_tmp$x##4783" "lq_tmp$x##581" | $k_##4782[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4781:=lq_tmp$x##4784]})])) -&gt; lq_tmp$x##4766:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4772 : a^"lq_tmp$x##4771" "lq_tmp$x##588" | $k_##4770[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4769:=lq_tmp$x##4772]} {lq_tmp$x##4776 : b^"lq_tmp$x##4775" "lq_tmp$x##589" | $k_##4774[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4773:=lq_tmp$x##4776]}) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##4780 : a^"lq_tmp$x##4779" "lq_tmp$x##592" | $k_##4778[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4777:=lq_tmp$x##4780]} {lq_tmp$x##4784 : b^"lq_tmp$x##4783" "lq_tmp$x##593" | $k_##4782[lq_tmp$x##4764:=Data.Functor.Identity.$fFunctorIdentity][VV##4781:=lq_tmp$x##4784]}))</span><span class='hs-varid'>plot_candle_values</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4813:(lq_tmp$x##4810:(lq_tmp$x##4809:{lq_tmp$x##4864 : [{lq_tmp$x##4859 : (Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##4857 : a^"lq_tmp$x##4837" | $k_##4836[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4841:=lq_tmp$x##4859][VV##4835:=lq_tmp$x##4857][VV##4854:=lq_tmp$x##4864]} {lq_tmp$x##4858 : b^"lq_tmp$x##4840" | $k_##4839[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4841:=lq_tmp$x##4859][VV##4838:=lq_tmp$x##4858][VV##4854:=lq_tmp$x##4864]})^"lq_tmp$x##4843" | $k_##4842[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4841:=lq_tmp$x##4859][VV##4854:=lq_tmp$x##4864]}]^"lq_tmp$x##4856" "lq_tmp$x##483" | $k_##4855[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4854:=lq_tmp$x##4864]} -&gt; (Data.Functor.Identity.Identity {lq_tmp$x##4894 : [{lq_tmp$x##4889 : (Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##4887 : a^"lq_tmp$x##4867" | $k_##4866[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894][VV##4871:=lq_tmp$x##4889][VV##4865:=lq_tmp$x##4887]} {lq_tmp$x##4888 : b^"lq_tmp$x##4870" | $k_##4869[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894][VV##4871:=lq_tmp$x##4889][VV##4868:=lq_tmp$x##4888]})^"lq_tmp$x##4873" | $k_##4872[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894][VV##4871:=lq_tmp$x##4889]}]^"lq_tmp$x##4886" "lq_tmp$x##484" | $k_##4885[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894]})) -&gt; lq_tmp$x##4811:(Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) -&gt; (Data.Functor.Identity.Identity (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b))) -&gt; lq_tmp$x##4814:{lq_tmp$x##4894 : [{lq_tmp$x##4889 : (Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##4887 : a^"lq_tmp$x##4867" | $k_##4866[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894][VV##4871:=lq_tmp$x##4889][VV##4865:=lq_tmp$x##4887]} {lq_tmp$x##4888 : b^"lq_tmp$x##4870" | $k_##4869[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894][VV##4871:=lq_tmp$x##4889][VV##4868:=lq_tmp$x##4888]})^"lq_tmp$x##4873" | $k_##4872[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894][VV##4871:=lq_tmp$x##4889]}]^"lq_tmp$x##4886" "lq_tmp$x##491" | $k_##4885[lq_tmp$x##4812:=fix$36$$36$dMonadState_axpm][VV##4884:=lq_tmp$x##4894]} -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Plot.Candle.PlotCandle a b) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varop'>.=</span></a> <span class='hs-varid'>cs</span>
<span class=hs-linenum> 50: </span>
<span class=hs-linenum> 51: </span>
<span class=hs-linenum> 52: </span><span class='hs-definition'>displayCandles</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>String</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum> 53: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##5598:[GHC.Types.Char] -&gt; lq_tmp$x##5599:[Coinbase.Exchange.Types.MarketData.Candle] -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>displayCandles</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>fileName</span></a> <a class=annot href="#"><span class=annottext>[Coinbase.Exchange.Types.MarketData.Candle]</span><span class='hs-varid'>candles</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 54: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5614 : [{lq_tmp$x##5638 : (Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##5636 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5629" | $k_##5628[lq_tmp$x##5619:=Lib.toChartCandle][lq_tmp$x##5620:=candles##aula][VV##5627:=lq_tmp$x##5636][VV##5633:=lq_tmp$x##5638]} {lq_tmp$x##5637 : GHC.Types.Double^"lq_tmp$x##5632" | $k_##5631[lq_tmp$x##5619:=Lib.toChartCandle][lq_tmp$x##5620:=candles##aula][VV##5630:=lq_tmp$x##5637][VV##5633:=lq_tmp$x##5638]})^"lq_tmp$x##5635" | $k_##5634[lq_tmp$x##5619:=Lib.toChartCandle][lq_tmp$x##5620:=candles##aula][VV##5633:=lq_tmp$x##5638]}] | len lq_tmp$x##5614 == len candles##aula}</span><span class='hs-varid'>plotPoints</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5620:[{lq_tmp$x##5626 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##5625" | $k_##5624[lq_tmp$x##5619:=Lib.toChartCandle][VV##5623:=lq_tmp$x##5626]}] -&gt; {lq_tmp$x##5614 : [{lq_tmp$x##5638 : (Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##5636 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5629" | $k_##5628[lq_tmp$x##5619:=Lib.toChartCandle][VV##5627:=lq_tmp$x##5636][VV##5633:=lq_tmp$x##5638]} {lq_tmp$x##5637 : GHC.Types.Double^"lq_tmp$x##5632" | $k_##5631[lq_tmp$x##5619:=Lib.toChartCandle][VV##5630:=lq_tmp$x##5637][VV##5633:=lq_tmp$x##5638]})^"lq_tmp$x##5635" | $k_##5634[lq_tmp$x##5619:=Lib.toChartCandle][VV##5633:=lq_tmp$x##5638]}] | len lq_tmp$x##5614 == len lq_tmp$x##5620}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5643 : lq_tmp$x##5644:{lq_tmp$x##5639 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##5430" | $k_##5429[VV##5428:=lq_tmp$x##5639]} -&gt; {lq_tmp$x##5642 : (Graphics.Rendering.Chart.Plot.Candle.Candle {lq_tmp$x##5640 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5434" | $k_##5433[VV##5432:=lq_tmp$x##5640][VV##5438:=lq_tmp$x##5642][ds_dz7D:=lq_tmp$x##5644]} {lq_tmp$x##5641 : GHC.Types.Double^"lq_tmp$x##5437" | $k_##5436[VV##5438:=lq_tmp$x##5642][VV##5435:=lq_tmp$x##5641][ds_dz7D:=lq_tmp$x##5644]})^"lq_tmp$x##5440" | $k_##5439[VV##5438:=lq_tmp$x##5642][ds_dz7D:=lq_tmp$x##5644]} | lq_tmp$x##5643 == Lib.toChartCandle}</span><span class='hs-varid'>toChartCandle</span></a> <span class='hs-varid'>candles</span>
<span class=hs-linenum> 55: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout {lq_tmp$x##5732 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5731" "lq_tmp$x##530" | $k_##5730[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][VV##5729:=lq_tmp$x##5732][lq_tmp$x##5726:=lq_anf$##7205759403792929032##dzeo]} {lq_tmp$x##5736 : GHC.Types.Double^"lq_tmp$x##5735" "lq_tmp$x##531" | $k_##5734[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][lq_tmp$x##5726:=lq_anf$##7205759403792929032##dzeo][VV##5733:=lq_tmp$x##5736]}) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varid'>renderedPlot</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##5726:(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout {lq_tmp$x##5732 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5731" "lq_tmp$x##520" | $k_##5730[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][VV##5729:=lq_tmp$x##5732]} {lq_tmp$x##5736 : GHC.Types.Double^"lq_tmp$x##5735" "lq_tmp$x##521" | $k_##5734[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][VV##5733:=lq_tmp$x##5736]}) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##5732 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5731" "lq_tmp$x##527" | $k_##5730[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][VV##5729:=lq_tmp$x##5732]} {lq_tmp$x##5736 : GHC.Types.Double^"lq_tmp$x##5735" "lq_tmp$x##528" | $k_##5734[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][VV##5733:=lq_tmp$x##5736]})) -&gt; (Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout {lq_tmp$x##5732 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5731" "lq_tmp$x##530" | $k_##5730[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][VV##5729:=lq_tmp$x##5732]} {lq_tmp$x##5736 : GHC.Types.Double^"lq_tmp$x##5735" "lq_tmp$x##531" | $k_##5734[lq_tmp$x##5725:=Graphics.Rendering.Chart.Plot.Candle.$fToPlotPlotCandle][VV##5733:=lq_tmp$x##5736]}) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ())</span><span class='hs-varid'>plot</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5666 : (Control.Monad.Trans.State.Lazy.StateT {lq_tmp$x##5690 : (Graphics.Rendering.Chart.Layout.Layout {lq_tmp$x##5688 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5681" | $k_##5680[lq_tmp$x##5669:=plotPoints##aulb][VV##5685:=lq_tmp$x##5690][VV##5679:=lq_tmp$x##5688]} {lq_tmp$x##5689 : GHC.Types.Double^"lq_tmp$x##5684" | $k_##5683[lq_tmp$x##5669:=plotPoints##aulb][VV##5685:=lq_tmp$x##5690][VV##5682:=lq_tmp$x##5689]})^"lq_tmp$x##5687" "lq_tmp$x##3713" | $k_##5686[lq_tmp$x##5669:=plotPoints##aulb][VV##5685:=lq_tmp$x##5690]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; $k_##3712[lq_tmp$x##5669:=plotPoints##aulb][VV##3711:=lq_tmp$x##5690][lq_tmp$x##5659:=lq_tmp$x##5690][lq_tmp$x##3688:=plotPoints##aulb][VV##3732:=lq_tmp$x##5666]} {lq_tmp$x##5662 : (Control.Monad.Trans.State.Lazy.StateT {lq_tmp$x##5660 : Graphics.Rendering.Chart.State.CState^"lq_tmp$x##3716" | $k_##3715[lq_tmp$x##5669:=plotPoints##aulb][lq_tmp$x##3688:=plotPoints##aulb][VV##3714:=lq_tmp$x##5660][VV##3720:=lq_tmp$x##5662][VV##3732:=lq_tmp$x##5666]} {lq_tmp$x##5661 : Data.Functor.Identity.Identity^"lq_tmp$x##3719" | $k_##3718[lq_tmp$x##5669:=plotPoints##aulb][lq_tmp$x##3688:=plotPoints##aulb][VV##3720:=lq_tmp$x##5662][VV##3732:=lq_tmp$x##5666][VV##3717:=lq_tmp$x##5661]})^"lq_tmp$x##3722" | $k_##3721[lq_tmp$x##5669:=plotPoints##aulb][lq_tmp$x##3688:=plotPoints##aulb][VV##3720:=lq_tmp$x##5662][VV##3732:=lq_tmp$x##5666]} {lq_tmp$x##5665 : (Graphics.Rendering.Chart.Plot.Candle.PlotCandle {lq_tmp$x##5674 : Data.Time.LocalTime.LocalTime.LocalTime^"lq_tmp$x##5673" "lq_tmp$x##3725" | $k_##5672[lq_tmp$x##5669:=plotPoints##aulb][VV##5671:=lq_tmp$x##5674]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; $k_##3724[lq_tmp$x##5669:=plotPoints##aulb][VV##3729:=lq_tmp$x##5665][lq_tmp$x##5663:=lq_tmp$x##5674][lq_tmp$x##3688:=plotPoints##aulb][VV##3723:=lq_tmp$x##5674][VV##3732:=lq_tmp$x##5666]} {lq_tmp$x##5678 : GHC.Types.Double^"lq_tmp$x##5677" "lq_tmp$x##3728" | $k_##5676[lq_tmp$x##5669:=plotPoints##aulb][VV##5675:=lq_tmp$x##5678]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    &amp;&amp; $k_##3727[lq_tmp$x##5669:=plotPoints##aulb][lq_tmp$x##5664:=lq_tmp$x##5678][VV##3729:=lq_tmp$x##5665][VV##3726:=lq_tmp$x##5678][lq_tmp$x##3688:=plotPoints##aulb][VV##3732:=lq_tmp$x##5666]})^"lq_tmp$x##3731" | $k_##3730[lq_tmp$x##5669:=plotPoints##aulb][VV##3729:=lq_tmp$x##5665][lq_tmp$x##3688:=plotPoints##aulb][VV##3732:=lq_tmp$x##5666]})^"lq_tmp$x##3734" | $k_##3733[lq_tmp$x##5669:=plotPoints##aulb][lq_tmp$x##3688:=plotPoints##aulb][VV##3732:=lq_tmp$x##5666]}</span><span class='hs-varid'>mkCandlePlot</span></a> <span class='hs-varid'>plotPoints</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 56: </span>  <a class=annot href="#"><span class=annottext>lq_tmp$x##5785:Graphics.Rendering.Chart.Backend.Diagrams.FileOptions -&gt; lq_tmp$x##5786:[GHC.Types.Char] -&gt; lq_tmp$x##5787:(Control.Monad.Trans.State.Lazy.StateT (Graphics.Rendering.Chart.Layout.Layout Data.Time.LocalTime.LocalTime.LocalTime GHC.Types.Double) (Control.Monad.Trans.State.Lazy.StateT Graphics.Rendering.Chart.State.CState Data.Functor.Identity.Identity) ()) -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>toFile</span></a> <a class=annot href="#"><span class=annottext>Graphics.Rendering.Chart.Backend.Diagrams.FileOptions</span><span class='hs-varid'>def</span></a> <span class='hs-varid'>fileName</span> <span class='hs-varid'>renderedPlot</span>
<span class=hs-linenum> 57: </span>
<span class=hs-linenum> 58: </span>
<span class=hs-linenum> 59: </span><span class='hs-comment'>-- | Delay requests to the api by a bit to make sure computer clock isn't ahead of API clock</span>
<span class=hs-linenum> 60: </span><span class='hs-definition'>apiDelayDuration</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NominalDiffTime</span>
<span class=hs-linenum> 61: </span><a class=annot href="#"><span class=annottext>{VV##5877 : Data.Time.Clock.UTC.NominalDiffTime^"lq_tmp$x##5879" | $k_##5878}</span><span class='hs-definition'>apiDelayDuration</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5880 : GHC.Integer.Type.Integer | lq_tmp$x##5880 == 10}</span><span class='hs-num'>10</span></a>
<span class=hs-linenum> 62: </span>
<span class=hs-linenum> 63: </span><span class='hs-comment'>-- | Number of candles you want -&gt; candle interval in minutes -&gt; (timestamp interval, granularity)</span>
<span class=hs-linenum> 64: </span><span class='hs-comment'>-- | For example 20 candles with 5 minute candles gives </span>
<span class=hs-linenum> 65: </span><span class='hs-definition'>getCandleRequestParams</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumCandles</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Minutes</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 66: </span><a class=annot href="#"><span class=annottext>ds_dz7e:{VV##5896 : Types.NumCandles^"lq_tmp$x##5898" | $k_##5897} -&gt; ds_dz7f:{VV##5900 : Types.Minutes^"lq_tmp$x##5902" | $k_##5901} -&gt; {VV##5914 : ({VV##5904 : GHC.Types.Int^"lq_tmp$x##5906" | $k_##5905}, {VV##5907 : GHC.Types.Int^"lq_tmp$x##5909" | $k_##5908})^"lq_tmp$x##5916" | $k_##5915}</span><span class='hs-definition'>getCandleRequestParams</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>NumCandles</span> <span class='hs-varid'>numCandles</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Minutes</span> <span class='hs-varid'>candleIntervalMinutes</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 67: </span>  <span class='hs-layout'>(</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##5957 : GHC.Types.Int^"lq_tmp$x##5956" | lq_tmp$x##5957 == numSeconds##aurd * lq_anf$##7205759403792929037##dzet}</span><span class='hs-varid'>numSeconds</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##5954:GHC.Types.Int -&gt; lq_tmp$x##5955:GHC.Types.Int -&gt; {lq_tmp$x##5957 : GHC.Types.Int^"lq_tmp$x##5956" | lq_tmp$x##5957 == lq_tmp$x##5954 * lq_tmp$x##5955}</span><span class='hs-varop'>*</span></a> <span class='hs-varid'>numCandles</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>numSeconds</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 68: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 69: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##5937 : GHC.Types.Int^"lq_tmp$x##5936" | lq_tmp$x##5937 == lq_anf$##7205759403792929035##dzer * lq_anf$##7205759403792929036##dzes}</span><span class='hs-varid'>numSeconds</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##5920 : GHC.Types.Int | lq_tmp$x##5920 == 60}</span><span class='hs-varid'>candleIntervalMinutes</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##5934:GHC.Types.Int -&gt; lq_tmp$x##5935:GHC.Types.Int -&gt; {lq_tmp$x##5937 : GHC.Types.Int^"lq_tmp$x##5936" | lq_tmp$x##5937 == lq_tmp$x##5934 * lq_tmp$x##5935}</span><span class='hs-varop'>*</span></a> <span class='hs-num'>60</span>
<span class=hs-linenum> 70: </span>
<span class=hs-linenum> 71: </span><span class='hs-comment'>-- | ExchangeConf: which exchange to run request on</span>
<span class=hs-linenum> 72: </span><span class='hs-comment'>-- | NumCandles: number of candles to get</span>
<span class=hs-linenum> 73: </span><span class='hs-comment'>-- | Minutes: duration of each candle</span>
<span class=hs-linenum> 74: </span><span class='hs-comment'>-- | For example you could say `getMostRecentCandles liveConfig (NumCandles 30) (Minutes 2)`</span>
<span class=hs-linenum> 75: </span><span class='hs-comment'>-- | Which would give the 30 most recent candles each spanning two minutes over a total of an hour long window</span>
<span class=hs-linenum> 76: </span><span class='hs-definition'>getMostRecentCandles</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ExchangeConf</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>NumCandles</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Minutes</span>
<span class=hs-linenum> 77: </span>                     <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span><span class='hs-varop'>.</span><span class='hs-conid'>ExchangeFailure</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 78: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##5991:Coinbase.Exchange.Types.ExchangeConf -&gt; lq_tmp$x##5992:Types.NumCandles -&gt; lq_tmp$x##5993:Types.Minutes -&gt; (GHC.Types.IO (Data.Either.Either Coinbase.Exchange.Types.ExchangeFailure [Coinbase.Exchange.Types.MarketData.Candle]))</span><span class='hs-definition'>getMostRecentCandles</span></a> <a class=annot href="#"><span class=annottext>Coinbase.Exchange.Types.ExchangeConf</span><span class='hs-varid'>conf</span></a> <a class=annot href="#"><span class=annottext>Types.NumCandles</span><span class='hs-varid'>numCandles</span></a> <a class=annot href="#"><span class=annottext>Types.Minutes</span><span class='hs-varid'>candleIntervalMinutes</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 79: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##6013 : GHC.Types.Int^"lq_tmp$x##6015" | $k_##6014}</span><span class='hs-varid'>timeWindow</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##6049 : GHC.Types.Int^"lq_tmp$x##6051" | $k_##6050}</span><span class='hs-varid'>granularity</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6006 : lq_tmp$x##6007:{lq_tmp$x##5998 : Types.NumCandles^"lq_tmp$x##5898" | $k_##5897[VV##5896:=lq_tmp$x##5998]} -&gt; lq_tmp$x##6008:{lq_tmp$x##5999 : Types.Minutes^"lq_tmp$x##5902" | $k_##5901[VV##5900:=lq_tmp$x##5999][ds_dz7e:=lq_tmp$x##6007]} -&gt; {lq_tmp$x##6004 : ({lq_tmp$x##6000 : GHC.Types.Int^"lq_tmp$x##5906" | $k_##5905[ds_dz7f:=lq_tmp$x##6008][ds_dz7e:=lq_tmp$x##6007][VV##5904:=lq_tmp$x##6000][VV##5914:=lq_tmp$x##6004]}, {lq_tmp$x##6001 : GHC.Types.Int^"lq_tmp$x##5909" | $k_##5908[ds_dz7f:=lq_tmp$x##6008][ds_dz7e:=lq_tmp$x##6007][VV##5907:=lq_tmp$x##6001][VV##5914:=lq_tmp$x##6004]})^"lq_tmp$x##5916" | $k_##5915[ds_dz7f:=lq_tmp$x##6008][ds_dz7e:=lq_tmp$x##6007][VV##5914:=lq_tmp$x##6004]} | lq_tmp$x##6006 == Lib.getCandleRequestParams}</span><span class='hs-varid'>getCandleRequestParams</span></a> <span class='hs-varid'>numCandles</span> <span class='hs-varid'>candleIntervalMinutes</span>
<span class=hs-linenum> 80: </span>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##6135 : Data.Time.Clock.UTC.UTCTime^"lq_tmp$x##6134" "lq_tmp$x##253" | $k_##6133[VV##6132:=lq_tmp$x##6135][lq_tmp$x##6123:=GHC.Base.$fFunctorIO][lq_tmp$x##6125:=Data.Time.Clock.POSIX.getCurrentTime][lq_tmp$x##6124:=lq_anf$##7205759403792929040##dzew]}</span><span class='hs-varid'>endTime</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO {lq_tmp$x##6135 : Data.Time.Clock.UTC.UTCTime^"lq_tmp$x##6134" "lq_tmp$x##253" | $k_##6133[VV##6132:=lq_tmp$x##6135][lq_tmp$x##6123:=GHC.Base.$fFunctorIO][lq_tmp$x##6125:=Data.Time.Clock.POSIX.getCurrentTime][lq_tmp$x##6124:=lq_anf$##7205759403792929040##dzew]})</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##6103 : lq_tmp$x##6104:Data.Time.Clock.UTC.NominalDiffTime -&gt; lq_tmp$x##6105:Data.Time.Clock.UTC.UTCTime -&gt; Data.Time.Clock.UTC.UTCTime | lq_tmp$x##6103 == Data.Time.Clock.UTCDiff.addUTCTime}</span><span class='hs-varid'>addUTCTime</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6094 : Data.Time.Clock.UTC.NominalDiffTime^"lq_tmp$x##6093" | lq_tmp$x##6094 == (-Lib.apiDelayDuration)}</span><span class='hs-comment'>-</span></a><span class='hs-varid'>apiDelayDuration</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##6124:(lq_tmp$x##6122:{lq_tmp$x##6131 : Data.Time.Clock.UTC.UTCTime^"lq_tmp$x##6130" "lq_tmp$x##247" | $k_##6129[lq_tmp$x##6123:=GHC.Base.$fFunctorIO][VV##6128:=lq_tmp$x##6131]} -&gt; {lq_tmp$x##6135 : Data.Time.Clock.UTC.UTCTime^"lq_tmp$x##6134" "lq_tmp$x##248" | $k_##6133[VV##6132:=lq_tmp$x##6135][lq_tmp$x##6123:=GHC.Base.$fFunctorIO]}) -&gt; lq_tmp$x##6125:(GHC.Types.IO {lq_tmp$x##6131 : Data.Time.Clock.UTC.UTCTime^"lq_tmp$x##6130" "lq_tmp$x##251" | $k_##6129[lq_tmp$x##6123:=GHC.Base.$fFunctorIO][VV##6128:=lq_tmp$x##6131]}) -&gt; (GHC.Types.IO {lq_tmp$x##6135 : Data.Time.Clock.UTC.UTCTime^"lq_tmp$x##6134" "lq_tmp$x##253" | $k_##6133[VV##6132:=lq_tmp$x##6135][lq_tmp$x##6123:=GHC.Base.$fFunctorIO]})</span><span class='hs-varop'>&lt;$&gt;</span></a> <span class='hs-varid'>getCurrentTime</span>
<span class=hs-linenum> 81: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>Data.Time.Clock.UTC.UTCTime</span><span class='hs-varid'>startTime</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##6204 : lq_tmp$x##6205:Data.Time.Clock.UTC.NominalDiffTime -&gt; lq_tmp$x##6206:Data.Time.Clock.UTC.UTCTime -&gt; Data.Time.Clock.UTC.UTCTime | lq_tmp$x##6204 == Data.Time.Clock.UTCDiff.addUTCTime}</span><span class='hs-varid'>addUTCTime</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##6189:GHC.Types.Int -&gt; Data.Time.Clock.UTC.NominalDiffTime</span><span class='hs-varid'>realToFrac</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##6173 : GHC.Types.Int^"lq_tmp$x##6172" | lq_tmp$x##6173 == (-timeWindow##axf8)}</span><span class='hs-comment'>-</span></a><span class='hs-varid'>timeWindow</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>endTime</span>
<span class=hs-linenum> 82: </span>  <a class=annot href="#"><span class=annottext>lq_tmp$x##6313:(Coinbase.Exchange.Types.ExchangeT GHC.Types.IO {lq_tmp$x##6327 : [{lq_tmp$x##6324 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##6316" | $k_##6315[lq_tmp$x##6312:=conf##aure][VV##6314:=lq_tmp$x##6324][VV##6321:=lq_tmp$x##6327]}]^"lq_tmp$x##6323" "lq_tmp$x##447" | $k_##6322[lq_tmp$x##6312:=conf##aure][VV##6321:=lq_tmp$x##6327]}) -&gt; (GHC.Types.IO (Data.Either.Either Coinbase.Exchange.Types.ExchangeFailure {lq_tmp$x##6327 : [{lq_tmp$x##6324 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##6316" | $k_##6315[lq_tmp$x##6312:=conf##aure][VV##6314:=lq_tmp$x##6324][VV##6321:=lq_tmp$x##6327]}]^"lq_tmp$x##6323" "lq_tmp$x##450" | $k_##6322[lq_tmp$x##6312:=conf##aure][VV##6321:=lq_tmp$x##6327]}))</span><span class='hs-varid'>runExchange</span></a> <span class='hs-varid'>conf</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##6274:Coinbase.Exchange.Types.Core.ProductId -&gt; lq_tmp$x##6275:(GHC.Base.Maybe Data.Time.Clock.UTC.UTCTime) -&gt; lq_tmp$x##6276:(GHC.Base.Maybe Data.Time.Clock.UTC.UTCTime) -&gt; lq_tmp$x##6277:(GHC.Base.Maybe GHC.Types.Int) -&gt; (Coinbase.Exchange.Types.ExchangeT GHC.Types.IO [Coinbase.Exchange.Types.MarketData.Candle])</span><span class='hs-varid'>getHistory</span></a>
<span class=hs-linenum> 83: </span>                          <span class='hs-varid'>ethUSDticker</span>
<span class=hs-linenum> 84: </span>                          <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>startTime</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 85: </span>                          <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>endTime</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 86: </span>                          <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>granularity</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 87: </span>    
<span class=hs-linenum> 88: </span><span class='hs-definition'>ema</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>EMA</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>EMA</span>
<span class=hs-linenum> 89: </span><a class=annot href="#"><span class=annottext>ds_dz70:{VV##7875 : Lib.EMA^"lq_tmp$x##7877" | $k_##7876} -&gt; candles##ausf:{VV##7886 : [{VV##7879 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7881" | $k_##7880}]^"lq_tmp$x##7888" | $k_##7887} -&gt; {VV##7890 : Lib.EMA^"lq_tmp$x##7892" | $k_##7891}</span><span class='hs-definition'>ema</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>EMA</span> <span class='hs-varid'>prevEMA</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV##7886 : [{VV##7879 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7881" | $k_##7880}]^"lq_tmp$x##7888" | $k_##7887}</span><span class='hs-varid'>candles</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-varid'>candle</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8185 : lq_tmp$x##8186:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; Lib.EMA | lq_tmp$x##8185 == Lib.EMA}</span><span class='hs-conid'>EMA</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##8147 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8145" | lq_tmp$x##8147 == lq_anf$##7205759403792929086##dzfg * multiplier##aush}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##8103 : lq_tmp$x##8104:{lq_tmp$x##8100 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7322" | $k_##7321[VV##7320:=lq_tmp$x##8100]} -&gt; {lq_tmp$x##8102 : (GHC.Real.Ratio {lq_tmp$x##8101 : GHC.Integer.Type.Integer^"lq_tmp$x##7326" | $k_##7325[ds_dz6H:=lq_tmp$x##8104][VV##7324:=lq_tmp$x##8101][VV##7327:=lq_tmp$x##8102]})^"lq_tmp$x##7329" | $k_##7328[ds_dz6H:=lq_tmp$x##8104][VV##7327:=lq_tmp$x##8102]} | lq_tmp$x##8103 == Lib.getClosePrice}</span><span class='hs-varid'>getClosePrice</span></a> <span class='hs-varid'>candle</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##8119:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##8120:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {lq_tmp$x##8124 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8122" | lq_tmp$x##8124 == lq_tmp$x##8119 - lq_tmp$x##8120}</span><span class='hs-comment'>-</span></a> <span class='hs-varid'>prevEMA</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##8142:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##8143:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {lq_tmp$x##8147 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8145" | lq_tmp$x##8147 == lq_tmp$x##8142 * lq_tmp$x##8143}</span><span class='hs-varop'>*</span></a> <span class='hs-varid'>multiplier</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##8168:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##8169:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {lq_tmp$x##8173 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8171" | lq_tmp$x##8173 == lq_tmp$x##8168 + lq_tmp$x##8169}</span><span class='hs-varop'>+</span></a> <span class='hs-varid'>prevEMA</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 90: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 91: </span>    <span class='hs-varid'>multiplier</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum> 92: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##8091 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8089" | lq_tmp$x##8091 == lq_anf$##7205759403792929078##dzf8 / lq_anf$##7205759403792929083##dzfd
                                                                               &amp;&amp; lq_tmp$x##8091 == lq_anf$##7205759403792929078##dzf8 / lq_anf$##7205759403792929083##dzfd}</span><span class='hs-varid'>multiplier</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##7984:GHC.Integer.Type.Integer -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>toRational</span></a> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##8086:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##8087:{lq_tmp$x##8091 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8089" | lq_tmp$x##8091 /= 0
                                                                                                                                                          &amp;&amp; lq_tmp$x##8091 /= 0.0} -&gt; {lq_tmp$x##8091 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8089" | lq_tmp$x##8091 == lq_tmp$x##8086 / lq_tmp$x##8087
                                                                                                                                                                                                                                                                      &amp;&amp; lq_tmp$x##8091 == lq_tmp$x##8086 / lq_tmp$x##8087}</span><span class='hs-varop'>/</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##8028:GHC.Types.Int -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>toRational</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>xs:[{lq_tmp$x##8013 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##8012" | $k_##8011[VV##8010:=lq_tmp$x##8013]}] -&gt; {lq_tmp$x##7996 : GHC.Types.Int | lq_tmp$x##7996 &gt;= 0
                                                                                                                                                              &amp;&amp; lq_tmp$x##7996 == len xs}</span><span class='hs-varid'>length</span></a> <span class='hs-varid'>candles</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##8063:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##8064:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; {lq_tmp$x##8068 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8066" | lq_tmp$x##8068 == lq_tmp$x##8063 + lq_tmp$x##8064}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##8048 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##8046" | lq_tmp$x##8048 == lq_anf$##7205759403792929081##dzfb}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span><span class='hs-comment'>-- Not sure what the difference between ratio and rational are and when I should use which ?</span>
<span class=hs-linenum> 95: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>SMA</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SMA</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum> 96: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Show.Show Lib.SMA)</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq {lq_tmp$x##2893 : Lib.SMA^"lq_tmp$x##2892" "lq_tmp$x##820" | $k_##2891[lq_tmp$x##2888:=fix$36$$36$c$61$$61$$35$$35$axGr][VV##2890:=lq_tmp$x##2893][lq_tmp$x##2889:=fix$36$$36$c$47$$61$$35$$35$axGK]})</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Num.Num Lib.SMA)</span><span class='hs-conid'>Num</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 97: </span><span class='hs-keyword'>newtype</span> <span class='hs-conid'>EMA</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>EMA</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum> 98: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(GHC.Show.Show Lib.EMA)</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Classes.Eq {lq_tmp$x##2100 : Lib.EMA^"lq_tmp$x##2099" "lq_tmp$x##820" | $k_##2098[lq_tmp$x##2096:=fix$36$$36$c$47$$61$$35$$35$axJK][VV##2097:=lq_tmp$x##2100][lq_tmp$x##2095:=fix$36$$36$c$61$$61$$35$$35$axJr]})</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Num.Num Lib.EMA)</span><span class='hs-conid'>Num</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-definition'>getClosePrice</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CoinbaseCandle</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Rational</span>
<span class=hs-linenum>101: </span><a class=annot href="#"><span class=annottext>ds_dz6H:{VV##7320 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7322" | $k_##7321} -&gt; {VV##7327 : (GHC.Real.Ratio {VV##7324 : GHC.Integer.Type.Integer^"lq_tmp$x##7326" | $k_##7325})^"lq_tmp$x##7329" | $k_##7328}</span><span class='hs-definition'>getClosePrice</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Coinbase</span><span class='hs-varop'>.</span><span class='hs-conid'>Exchange</span><span class='hs-varop'>.</span><span class='hs-conid'>MarketData</span><span class='hs-varop'>.</span><span class='hs-conid'>Candle</span> <span class='hs-varid'>utcTime</span> <span class='hs-varid'>l</span> <span class='hs-varid'>h</span> <span class='hs-varid'>o</span> <span class='hs-varid'>c</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##7387:GHC.Types.Double -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>toRational</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##7375 : lq_tmp$x##7376:Coinbase.Exchange.Types.MarketData.Close -&gt; GHC.Types.Double | lq_tmp$x##7375 == Coinbase.Exchange.Types.MarketData.unClose}</span><span class='hs-varid'>unClose</span></a> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-definition'>sma</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>CoinbaseCandle</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SMA</span>
<span class=hs-linenum>104: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##7395:[Coinbase.Exchange.Types.MarketData.Candle] -&gt; Lib.SMA</span><span class='hs-definition'>sma</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7442 : lq_tmp$x##7443:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; Lib.SMA | lq_tmp$x##7442 == Lib.SMA}</span><span class='hs-conid'>SMA</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7433 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##7431" | lq_tmp$x##7433 == lq_anf$##7205759403792929071##dzf1}</span><span class='hs-num'>0</span></a> 
<span class=hs-linenum>105: </span><span class='hs-definition'>sma</span> <span class='hs-varid'>candles</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7869 : lq_tmp$x##7870:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; Lib.SMA | lq_tmp$x##7869 == Lib.SMA}</span><span class='hs-conid'>SMA</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##7813 : lq_tmp$x##7815:{lq_tmp$x##7810 : [{lq_tmp$x##7807 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7731" | $k_##7730[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7729:=lq_tmp$x##7807][lq_tmp$x##7742:=lq_tmp$x##7810][lq_tmp$x##7739:=lq_tmp$x##7807][VV##7736:=lq_tmp$x##7810]}]^"lq_tmp$x##7738" | $k_##7737[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][lq_tmp$x##7742:=lq_tmp$x##7810][VV##7736:=lq_tmp$x##7810]} -&gt; {lq_tmp$x##7812 : (GHC.Real.Ratio {lq_tmp$x##7811 : GHC.Integer.Type.Integer^"lq_tmp$x##7723" "lq_tmp$x##7745" | $k_##7722[xcmp:=lq_tmp$x##7815][lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7743:=lq_tmp$x##7811][VV##7746:=lq_tmp$x##7812][VV##7721:=lq_tmp$x##7811][VV##7724:=lq_tmp$x##7812][lq_tmp$x##7728:=lq_tmp$x##7812][lq_tmp$x##7727:=lq_tmp$x##7811]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &amp;&amp; $k_##7744[xcmp:=lq_tmp$x##7815][lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7743:=lq_tmp$x##7811][VV##7746:=lq_tmp$x##7812][lq_tmp$x##7749:=lq_tmp$x##7815][lq_tmp$x##7728:=lq_tmp$x##7812][lq_tmp$x##7727:=lq_tmp$x##7811]})^"lq_tmp$x##7726" "lq_tmp$x##7748" | $k_##7725[xcmp:=lq_tmp$x##7815][lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7724:=lq_tmp$x##7812][lq_tmp$x##7728:=lq_tmp$x##7812]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              &amp;&amp; $k_##7747[xcmp:=lq_tmp$x##7815][lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7746:=lq_tmp$x##7812][lq_tmp$x##7749:=lq_tmp$x##7815][lq_tmp$x##7728:=lq_tmp$x##7812]} | lq_tmp$x##7813 == totalSum##ausp}</span><span class='hs-varid'>totalSum</span></a> <span class='hs-varid'>candles</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##7852:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##7853:{lq_tmp$x##7857 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##7855" | lq_tmp$x##7857 /= 0
                                                                                                                                                          &amp;&amp; lq_tmp$x##7857 /= 0.0} -&gt; {lq_tmp$x##7857 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##7855" | lq_tmp$x##7857 == lq_tmp$x##7852 / lq_tmp$x##7853
                                                                                                                                                                                                                                                                      &amp;&amp; lq_tmp$x##7857 == lq_tmp$x##7852 / lq_tmp$x##7853}</span><span class='hs-varop'>/</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7828 : (GHC.Real.Ratio {lq_tmp$x##7827 : GHC.Integer.Type.Integer^"lq_tmp$x##7502" | $k_##7501[VV##7500:=lq_tmp$x##7827][lq_tmp$x##7489:=ds_dz6Q][VV##7503:=lq_tmp$x##7828][lq_tmp$x##7831:=ds_dz6Q]})^"lq_tmp$x##7505" | $k_##7504[lq_tmp$x##7489:=ds_dz6Q][VV##7503:=lq_tmp$x##7828][lq_tmp$x##7831:=ds_dz6Q]}</span><span class='hs-varid'>numCandles</span></a> <span class='hs-varid'>candles</span><span class='hs-layout'>)</span>
<span class=hs-linenum>106: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>107: </span>    <a class=annot href="#"><span class=annottext>xcmp:{lq_tmp$x##7742 : [{lq_tmp$x##7739 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7731" | $k_##7730[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7729:=lq_tmp$x##7739][VV##7736:=lq_tmp$x##7742]}]^"lq_tmp$x##7738" | $k_##7737[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7736:=lq_tmp$x##7742]} -&gt; {lq_tmp$x##7728 : (GHC.Real.Ratio {lq_tmp$x##7727 : GHC.Integer.Type.Integer^"lq_tmp$x##7723" "lq_tmp$x##7745" | $k_##7722[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7743:=lq_tmp$x##7727][VV##7746:=lq_tmp$x##7728][VV##7721:=lq_tmp$x##7727][VV##7724:=lq_tmp$x##7728]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; $k_##7744[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7743:=lq_tmp$x##7727][VV##7746:=lq_tmp$x##7728][lq_tmp$x##7749:=xcmp]})^"lq_tmp$x##7726" "lq_tmp$x##7748" | $k_##7725[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7724:=lq_tmp$x##7728]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  &amp;&amp; $k_##7747[lq_tmp$db##14:=lq_anf$##7205759403792929066##dzeW][lq_tmp$db##16:=lq_anf$##7205759403792929067##dzeX][VV##7746:=lq_tmp$x##7728][lq_tmp$x##7749:=xcmp]}</span><span class='hs-varid'>totalSum</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##194:[(GHC.Real.Ratio GHC.Integer.Type.Integer)] -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>sum</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##7677:[{lq_tmp$x##7683 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7682" | $k_##7681[VV##7680:=lq_tmp$x##7683][lq_tmp$x##7676:=Lib.getClosePrice]}] -&gt; {lq_tmp$x##7671 : [{lq_tmp$x##7691 : (GHC.Real.Ratio {lq_tmp$x##7690 : GHC.Integer.Type.Integer^"lq_tmp$x##7686" | $k_##7685[VV##7687:=lq_tmp$x##7691][lq_tmp$x##7676:=Lib.getClosePrice][VV##7684:=lq_tmp$x##7690]})^"lq_tmp$x##7689" | $k_##7688[VV##7687:=lq_tmp$x##7691][lq_tmp$x##7676:=Lib.getClosePrice]}] | len lq_tmp$x##7671 == len lq_tmp$x##7677}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##7695 : lq_tmp$x##7696:{lq_tmp$x##7692 : Coinbase.Exchange.Types.MarketData.Candle^"lq_tmp$x##7322" | $k_##7321[VV##7320:=lq_tmp$x##7692]} -&gt; {lq_tmp$x##7694 : (GHC.Real.Ratio {lq_tmp$x##7693 : GHC.Integer.Type.Integer^"lq_tmp$x##7326" | $k_##7325[ds_dz6H:=lq_tmp$x##7696][VV##7324:=lq_tmp$x##7693][VV##7327:=lq_tmp$x##7694]})^"lq_tmp$x##7329" | $k_##7328[ds_dz6H:=lq_tmp$x##7696][VV##7327:=lq_tmp$x##7694]} | lq_tmp$x##7695 == Lib.getClosePrice}</span><span class='hs-varid'>getClosePrice</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>108: </span>    <a class=annot href="#"><span class=annottext>lq_tmp$x##7489:{VV##7497 : [{VV##7490 : a^"lq_tmp$x##7492" | $k_##7491}]^"lq_tmp$x##7499" | $k_##7498} -&gt; {VV##7503 : (GHC.Real.Ratio {VV##7500 : GHC.Integer.Type.Integer^"lq_tmp$x##7502" | $k_##7501})^"lq_tmp$x##7505" | $k_##7504}</span><span class='hs-varid'>numCandles</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##7517:GHC.Types.Int -&gt; {lq_tmp$x##7523 : (GHC.Real.Ratio GHC.Integer.Type.Integer)^"lq_tmp$x##7521" | lq_tmp$x##7523 == lq_tmp$x##7517}</span><span class='hs-varid'>fromIntegral</span></a> <span class='hs-varop'>.</span> <a class=annot href="#"><span class=annottext>xs:[a] -&gt; {lq_tmp$x##7535 : GHC.Types.Int | lq_tmp$x##7535 &gt;= 0
                                            &amp;&amp; lq_tmp$x##7535 == len xs}</span><span class='hs-varid'>length</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>109: </span>    
</pre>
</body>
</html>